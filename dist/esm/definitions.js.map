{"version":3,"file":"definitions.js","sourceRoot":"","sources":["../../src/definitions.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAC;AA+E5C,MAAM,OAAO,MAAM;IAsBjB,YAAY,KAAa;QACvB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAED,MAAM,CAAC,SAAS;QACd,OAAO,SAAS,CAAC,WAAW,EAAE,KAAK,SAAS;YAC1C,CAAC,CAAC;gBACE,IAAI,CAAC,YAAY;gBACjB,IAAI,CAAC,gBAAgB;gBACrB,IAAI,CAAC,KAAK;gBACV,IAAI,CAAC,KAAK;gBACV,IAAI,CAAC,QAAQ;gBACb,IAAI,CAAC,SAAS;gBACd,IAAI,CAAC,0BAA0B;gBAC/B,IAAI,CAAC,SAAS;gBACd,IAAI,CAAC,aAAa;gBAClB,IAAI,CAAC,eAAe;gBACpB,IAAI,CAAC,OAAO;gBACZ,IAAI,CAAC,iBAAiB;gBACtB,IAAI,CAAC,OAAO;gBACZ,IAAI,CAAC,OAAO;gBACZ,IAAI,CAAC,UAAU;gBACf,IAAI,CAAC,UAAU;gBACL,IAAI,CAAC,eAAe;aAC/B;YACH,CAAC,CAAC;gBACE,IAAI,CAAC,YAAY;gBACjB,IAAI,CAAC,gBAAgB;gBACrB,IAAI,CAAC,KAAK;gBACV,IAAI,CAAC,KAAK;gBACV,IAAI,CAAC,QAAQ;gBACb,IAAI,CAAC,SAAS;gBACd,IAAI,CAAC,0BAA0B;gBAC/B,IAAI,CAAC,SAAS;gBACd,IAAI,CAAC,aAAa;gBAClB,IAAI,CAAC,QAAQ;gBACb,IAAI,CAAC,eAAe;gBAClB,IAAI,CAAC,UAAU;gBACP,IAAI,CAAC,eAAe;aAC/B,CAAC;IACR,CAAC;;AA3DM,mBAAY,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC7B,uBAAgB,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACjC,YAAK,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,YAAK,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,eAAQ,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACzB,gBAAS,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC1B,iCAA0B,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC3C,gBAAS,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC1B,oBAAa,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC9B,eAAQ,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACzB,sBAAe,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAChC,cAAO,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACxB,wBAAiB,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAClC,cAAO,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACxB,cAAO,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AACxB,iBAAU,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC3B,iBAAU,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC;AAC3B,sBAAe,GAAG,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC","sourcesContent":["import { Capacitor } from '@capacitor/core';\n\nexport interface FreeraspPlugin {\n  addListener(listener: string, callback: (event: any) => void): any;\n  talsecStart(options: {\n    config: FreeraspConfig;\n  }): Promise<{ started: boolean }>;\n  onInvalidCallback(): void;\n  getThreatIdentifiers(): Promise<{ ids: number[] }>;\n  getThreatChannelData(): Promise<{ ids: [string, string, string] }>;\n  addToWhitelist(options: {\n    packageName: string;\n  }): Promise<{ result: boolean }>;\n  getAppIcon(options: { packageName: string }): Promise<{ result: string }>;\n  blockScreenCapture(options: {\n      enable: boolean;\n    }): Promise<{ result: boolean }>;\n  isScreenCaptureBlocked(): Promise<{ result: boolean }>;\n}\n\nexport type FreeraspConfig = {\n  androidConfig?: AndroidConfig;\n  iosConfig?: IOSConfig;\n  watcherMail: string;\n  isProd?: boolean;\n};\n\nexport type AndroidConfig = {\n  packageName: string;\n  certificateHashes: string[];\n  supportedAlternativeStores?: string[];\n  malwareConfig?: MalwareConfig;\n};\n\nexport type IOSConfig = {\n  appBundleId: string;\n  appTeamId: string;\n};\n\nexport type MalwareConfig = {\n  blacklistedHashes?: string[];\n  blacklistedPackageNames?: string[];\n  suspiciousPermissions?: string[][];\n  whitelistedInstallationSources?: string[];\n};\n\nexport type SuspiciousAppInfo = {\n  packageInfo: PackageInfo;\n  reason: string;\n};\n\nexport type PackageInfo = {\n  packageName: string;\n  appName?: string;\n  version?: string;\n  appIcon?: string;\n  installerStore?: string;\n};\n\nexport type NativeEventEmitterActions = {\n  privilegedAccess?: () => any;\n  debug?: () => any;\n  simulator?: () => any;\n  appIntegrity?: () => any;\n  unofficialStore?: () => any;\n  hooks?: () => any;\n  deviceBinding?: () => any;\n  deviceID?: () => any;\n  passcode?: () => any;\n  secureHardwareNotAvailable?: () => any;\n  obfuscationIssues?: () => any;\n  devMode?: () => any;\n  systemVPN?: () => any;\n  malware?: (suspiciousApps: SuspiciousAppInfo[]) => any;\n  adbEnabled?: () => any;\n  screenshot?: () => any;\n  screenRecording?: () => any;\n};\n\nexport class Threat {\n  value: number;\n\n  static AppIntegrity = new Threat(0);\n  static PrivilegedAccess = new Threat(0);\n  static Debug = new Threat(0);\n  static Hooks = new Threat(0);\n  static Passcode = new Threat(0);\n  static Simulator = new Threat(0);\n  static SecureHardwareNotAvailable = new Threat(0);\n  static SystemVPN = new Threat(0);\n  static DeviceBinding = new Threat(0);\n  static DeviceID = new Threat(0);\n  static UnofficialStore = new Threat(0);\n  static Overlay = new Threat(0);\n  static ObfuscationIssues = new Threat(0);\n  static DevMode = new Threat(0);\n  static Malware = new Threat(0);\n  static ADBEnabled = new Threat(0);\n  static Screenshot = new Threat(0);\n  static ScreenRecording = new Threat(0);\n\n  constructor(value: number) {\n    this.value = value;\n  }\n\n  static getValues(): Threat[] {\n    return Capacitor.getPlatform() === 'android'\n      ? [\n          this.AppIntegrity,\n          this.PrivilegedAccess,\n          this.Debug,\n          this.Hooks,\n          this.Passcode,\n          this.Simulator,\n          this.SecureHardwareNotAvailable,\n          this.SystemVPN,\n          this.DeviceBinding,\n          this.UnofficialStore,\n          this.Overlay,\n          this.ObfuscationIssues,\n          this.DevMode,\n          this.Malware,\n          this.ADBEnabled,\n          this.Screenshot,\n                    this.ScreenRecording,\n        ]\n      : [\n          this.AppIntegrity,\n          this.PrivilegedAccess,\n          this.Debug,\n          this.Hooks,\n          this.Passcode,\n          this.Simulator,\n          this.SecureHardwareNotAvailable,\n          this.SystemVPN,\n          this.DeviceBinding,\n          this.DeviceID,\n          this.UnofficialStore,\n            this.Screenshot,\n                    this.ScreenRecording,\n        ];\n  }\n}\n"]}