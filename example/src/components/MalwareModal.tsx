import React, { useState } from 'react';
import {
  IonList,
  IonModal,
  IonText,
  IonButton,
  IonItem,
  IonContent,
} from '@ionic/react';
import './MalwareModal.css';
import '../theme/variables.css';
import { SuspiciousAppInfo } from 'capacitor-freerasp';
import { MalwareItem } from './MalwareItem';

const MalwareModal: React.FC<{
  isDisabled: boolean;
  suspiciousApps: SuspiciousAppInfo[];
}> = ({ isDisabled, suspiciousApps }) => {
  const [modalVisible, setModalVisible] = useState(false);

  return (
    <>
      {!isDisabled && (
        <>
          <IonButton
            className="malwareButton"
            color="danger"
            disabled={isDisabled}
            onClick={() => setModalVisible(true)}
          >
            Details
          </IonButton>
        </>
      )}

      <IonModal
        animated={true}
        showBackdrop={true}
        isOpen={modalVisible}
        onWillDismiss={() => {
          setModalVisible(false);
        }}
      >
        <IonText className="textTitle">Detected malware:</IonText>

        <IonContent scrollY={true}>
          <IonList lines="none">
            {suspiciousApps.map((susApp, idx) => {
              return (
                <IonItem key={idx}>
                  <MalwareItem app={susApp} />
                </IonItem>
              );
            })}
          </IonList>
        </IonContent>
        <IonButton
          shape="round"
          size="default"
          className="malwareButton"
          onClick={() => setModalVisible(false)}
        >
          <IonText className="textStyle">Close</IonText>
        </IonButton>
      </IonModal>
    </>
  );
};

export default MalwareModal;
